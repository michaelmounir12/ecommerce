<!DOCTYPE html>
<html>
<head>
  <title>Product Details</title>
  <style>
    body {
  font-family: Arial, sans-serif;
}
.product-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  margin: 20px;
}
.product-image {
  max-width: 50%;
  background-size: cover;
  height: 78vh;
 
}
img {
  width: 100%;

}
.product-details {
  width: 50%;
  padding: 20px;
}
.product-title {
  font-size: 24px;
  font-weight: bold;
  margin-bottom: 10px;
}
.product-description {
  margin-bottom: 10px;
}
.product-price {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 10px;
}
.product-reviews {
  margin-top: 20px;
}
.review-form {
  margin-top: 20px;
}
.review-form label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}
.review-form input[type="text"],
.review-form textarea {
  display: block;
  width: 100%;
  padding: 5px;
  margin-bottom: 10px;
  border: 1px solid #ddd;
  border-radius: 3px;
  box-sizing: border-box;
}
.review-form input[type="submit"] {
  background-color: #007bff;
  color: #fff;
  border: none;
  border-radius: 3px;
  padding: 10px 20px;
  cursor: pointer;
}
.review-list {
  margin-top: 20px;
  list-style: none;
  padding: 0;
}
.review-item {
  margin-bottom: 10px;
  padding: 10px;
  background-color: #f5f5f5;
  border-radius: 3px;
}
.review-item .review-author {
  font-weight: bold;
  margin-bottom: 5px;
}
.review-item .review-rating {
  margin-bottom: 5px;
}
.review-item .review-text {
  margin-bottom: 5px;
}
  </style>
</head>
<body>
  <div id="{{id}}" class="product-container">
    <div class="product-image">
      <img src="" alt="Product Image">
    </div>
    <div class="product-details">
      <div class="product-title"></div>
      <div class="product-description"></div>
      <div class="product-price"></div>
      <div class="product-reviews">
        <div class="product-rating">
          <span class="product-rating-stars"></span>
          <span class="product-rating-count"></span>
        </div>
        <div class="review-form">
          <h1>Add Review</h1>
          <form action="/addreview/{{id}}" method="post" >
            <label for="review-name">Name:</label>
            <input type="text" id="review-name" name="name" required>
            <label for="review-rating">Rating:</label>
            <select id="review-rating" name="rating" required>
              <option value="">Select rating</option>
              <option value="1">1 star</option>
              <option value="2">2 stars</option>
              <option value="3">3 stars</option>
              <option value="4">4 stars</option>
              <option value="5">5 stars</option>
            </select>
            <label for="review-text">Review:</label>
            <textarea id="review-text" name="text" rows="3" required></textarea>
            <input class="btn" type="submit" value="Submit Review">
          </form>
        </div>
        <ul class="review-list">
         
        </ul>
      </div>
    </div>
  </div>
  <script>
    const img = document.querySelector("img");
const title = document.querySelector(".product-title");
const desc = document.querySelector(".product-description");
const price = document.querySelector(".product-price");
const stars = document.querySelector(".product-rating-stars");
const countRate = document.querySelector(".product-rating-count");
const revList = document.querySelector(".review-list");
const cont = document.querySelector(".product-container")


let proId = cont.id
const url = `https://ecommerce-new.onrender.com:5000/productCred/${proId}`;




function addPro(pro)
{
    


    img.src = pro.image;
    title.textContent = pro.title;
    desc.textContent = pro.desc;
    price.textContent = `${pro.price} EGP`;

    if(pro.rating === 1)
    {
        stars.textContent = "★☆☆☆☆"
    }
   else if(pro.rating === 2)
    {
        stars.textContent = "★★☆☆☆"
    }
   else if(pro.rating === 3)
    {
        stars.textContent = "★★★☆☆"
    }
  else  if(pro.rating === 4)
    {
        stars.textContent = "★★★★☆"
    }
   else if(pro.rating === 5)
    {
        stars.textContent = "★★★★★"
    }
    else
    {
        stars.textContent = "☆☆☆☆☆"
    }
    countRate.textContent = `(${pro.numofreviews})`

   pro.reviews.forEach((ele)=>
   {
    const revItem = document.createElement("li");
    revItem.classList.add("review-item");
    const revAuth = document.createElement("div");
    revAuth.classList.add("review-author");
    const revRate = document.createElement("div");
    revRate.classList.add("review-rating");
    const revText = document.createElement("div");
    revText.classList.add("review-text"); 
    revItem.append(revAuth);
    revItem.append(revRate);
    revItem.append(revText);
    revAuth.textContent = ele.name;
    
    if(ele.rating === 1)
    {
        revRate.textContent = "★☆☆☆☆"
    }
   else if(ele.rating === 2)
    {
        revRate.textContent = "★★☆☆☆"
    }
   else if(ele.rating === 3)
    {
        revRate.textContent = "★★★☆☆"
    }
  else  if(ele.rating === 4)
    {
        revRate.textContent = "★★★★☆"
    }
   else if(ele.rating === 5)
    {
        revRate.textContent = "★★★★★"
    }
  
    
    revText.textContent = ele.comment;
    revList.append(revItem);


      
   })

    
}


fetch(url, {
     
    method: "GET",
     
  
})
.then(response => response.json())
.then(data =>addPro(data.pro))
.catch(error => console.error(error));
  </script>
</body>
</html>